<html>
	<head>
				
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>

		<!--<script src="../assets/jqueryplugs/color-picker/jquery.colorPicker.min.js"></script>
		<link rel="stylesheet" href="../assets/jqueryplugs/color-picker/colorPicker.css" type="text/css" /> -->

		<script type="text/javascript" src="../../../frameworks/jquery/plugins/simple-color-picker/jquery.colorPicker.min.js"></script>
		<link rel="stylesheet" type="text/css" href="../../../frameworks/jquery/plugins/simple-color-picker/colorPicker.css">




		<script type="text/javascript">


            function area(){

                this.fillSize=1;
                this.obj={};

                this.changeColor=function(color){
                    // area.obj.beginPath();
                    // area.obj.lineWidth = 1;
                    // area.obj.strokeStyle = color;

                    this.obj.fillStyle = color;
                    this.obj.strokeStyle = color;

                };

                this.changeSize=function(){
                    return true;
                };

                this.drow = function(x,y){
                    this.obj.beginPath();
                    this.obj.arc(x, y, this.fillSize, 0, Math.PI * 2, false);
                    this.obj.closePath();
                    this.obj.fill(); // Заливка окружности
                };

                this.drow1 = function(x,y){
                    this.obj.beginPath();
                    this.obj.arc(x, y, this.fillSize, 0, Math.PI * 2, false);
                    this.obj.closePath();
//                    this.obj.fill(); // Заливка окружности
                    this.obj.strokeStyle = '#999';

                    this.obj.stroke();

                };

                this.line=function(x,y,xto,yto){
                    this.obj.beginPath();
                    this.obj.lineWidth = this.fillSize*2;
//                    area.obj.strokeStyle = 'red';
                    this.obj.moveTo(x, y);
                    this.obj.lineTo(xto, yto);
                    this.obj.stroke();
                };

            }

//			area = {
//
//				fillSize:1,
//				obj:{},
//				changeColor:function(color){
//				    // area.obj.beginPath();
//				    // area.obj.lineWidth = 1;
//				    // area.obj.strokeStyle = color;
//
//				    area.obj.fillStyle = color;
//                    area.obj.strokeStyle = color;
//
//				},
//				changeSize:function(){
//					return true;
//				},
//				drow:function(x,y){
//                    this.obj.beginPath();
//                    this.obj.arc(x, y, area.fillSize, 0, Math.PI * 2, false);
//                    this.obj.closePath();
//                    this.obj.fill(); // Заливка окружности
//				},
//                line:function(x,y,xto,yto){
//                    area.obj.beginPath();
//                    area.obj.lineWidth = area.fillSize*2;
////                    area.obj.strokeStyle = 'red';
//                    area.obj.moveTo(x, y);
//                    area.obj.lineTo(xto, yto);
//                    area.obj.stroke();
//                }
//			}

		</script>

		<script  type="text/javascript">



		$(function(){

			// $('#color1').ColorPicker({});


			// $('#color1').colorPicker({pickerDefault: "ffffff"});
			$('#color1').colorPicker( {onColorChange : function(id, newValue) { 

					// console.log("ID: " + id + " has been changed to " + newValue); 
					area_main.changeColor(newValue);
//                    area_main.changeColor(newValue);

				}
			} );


			$('#color2').colorPicker( {onColorChange : function(id, newValue) { 

					// console.log("ID: " + id + " has been changed to " + newValue); 
					// area.changeColor(newValue);
					$("#area").css("background-color",newValue);

				}
			} );


			$("#area_cursor").mouseout(function(){
				area_cursor.obj.clearRect(0,0,800,600);
			});


			var status_press = 0;


		    var canvas1 = $("#area")[0];
		    var obCanvas = canvas1.getContext('2d');




            var canvas2 = $("#area_cursor")[0];
            var obCanvas2 = canvas2.getContext('2d');

		    // obCanvas.beginPath();
		    // obCanvas.lineWidth = 1;
		    // obCanvas.strokeStyle = 'black';


            area_main = new area();
		    area_main.obj = obCanvas;


            area_cursor = new area();
            area_cursor.obj = obCanvas2;
//            area = obCanvas2;
		    
		 //    area.obj.beginPath();
		 //    area.obj.lineWidth = 1;
		 //    area.obj.beginPath();
			// area.obj.strokeStyle = "black"

//			area.obj.fillStyle = "black";


		   	$(document).mousedown(function(){
		   		status_press = 1;
		   		
		   	}); 	


			$(document).mouseup(function(){

		   		status_press = 0;
		   				
		   	}); 	

		   	$("#area_cursor").mousemove(function(e){
		   		


//                console.log(e.pageX + " - " + $(this).offset());




                posX = e.pageX - $(this).offset().left - 1;
                posY = e.pageY - $(this).offset().top - 1;


                area_cursor.obj.clearRect(0,0,800,600);
                area_cursor.drow1(posX,posY);




		   		if (status_press == 1){

					area_main.drow(posX,posY);



		   			if (typeof posXh != "undefined"){


                        area_main.line(posXh,posYh,posX,posY);

		   			}


				}

				posXh = posX;
	   			posYh = posY;

		   		
		   		

		   	}); 

		   	$("#colors li").click(function(){
		   		// console.log($(this).attr("class"));

		   		

		   		area.changeColor($(this).attr("class"));
		   	});	

		});

		</script>

		<style>
			#area{
				border: 1px solid #899889;
			}

			#colors{
				padding: 10px;
				/*border-radius: 5px;*/
				background-color: rgba(0,0,0,0.5);
				position: absolute;
				float: left;
				top: 8;
				left: 8;
				/*height: 600px;*/
				width: 781px;
				/*height: 50px;*/
			}

			#colors div{
				float: left;
				
			}
			#colors div + div{
				margin-left: 25px;
			}

			#colors a {
				color: white;
			}

			#colors li {
				height: 30px;
				width: 30px;
				background-color: #333;
				list-style: none;
				margin-top: 10px;
				border-radius: 15px;
				margin-right: 10px;
				cursor: pointer;
			}

			#colors li.red{
				background-color: red;

			}
			#colors li.green{
				background-color: green;				
			}
			#colors li.blue{
				background-color: blue;
			}

			label {
				color: white;
			}

			#size{
				width:25px;
				color: white;
			}


            #area_cursor{
                /*background-color: rgba(0,0,0,0.5);*/
                position: absolute;
                top:9;
                left:9;
                cursor: none;
            }
		</style>
	</head>
	<body>

		<canvas id="area" width="800px" height="600px"></canvas>
        <canvas id="area_cursor" width="800px" height="600px"></canvas>



		<div id="colors">
			<div><label for="color1">&nbsp;Color</label> <input id="color1" type="button" name="color1" value="#000000" /></div>
			<div style="float:left;"><label for="color2">&nbsp;Background</label> <input id="color2" type="text" name="color2" value="#ffffff" /></div>


			<div><label>&nbsp;Size</label><input type="range" id="weight" min=0  max=50 value=0 step=10 onchange="v=(this.value==0) ? 1 : this.value;   area_main.fillSize=v; area_cursor.fillSize=v; $('#size').html(v);"></div><div for=fader id="size" >1</div>
			<div><a href="#" onclick="area_main.obj.clearRect(0,0,800,600)">Clear</a></div>
		</div>
	</body>
</html>
